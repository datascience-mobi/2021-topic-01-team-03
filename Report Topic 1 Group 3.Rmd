---
title: "Topic 1 Group 3: Drug viability screens for oncological and non-oncological treatments"
author: "Cedrik Neber, Lea Ahrens, Lennard Kleemann, Ilya Schneider, Xenia Quaas"
date: "19 7 2021"
output:
  html_document: default
---

Drug repurposing is a strategy in which already authorized drugs are used to treat diseases for which they were not intended. This has advantages, especially in terms of cost, time and the risk to fail in research and development of a new drug. In this context, computational approaches are gaining in importance, as they allow large amounts of data to be analyzed (Pushpakom *et al.*, 2019).

According to the Global Cancer Statistics 2020, brain cancer is a rarer cancer type, accounting for 2,5% of all new cancers. Nevertheless, its mortality rate is comparatively high, which makes drug repurposing an interesting application.


#Structure of our project

This project uses seven datasets generated by the Broad Institute using the PRISM strategy. It investigates the general question of whether it is possible to predict the effectiveness of a drug in the treatment of brain cancer. 

To explore our main question, we examined four milestones:

**1) How can we distinguish the most effective drugs?**
**2) What are the targets of the effective drugs?**
**3) Are there any genetic markers that are specific for brain cancer subtypes?**
**4) What other factors contribute to drug and effectiveness prediction?**

#Data Clean up

As the datasets also contain information on other cancer types, we removed non-relevant cell lines. In addition, we classified the datasets according to brain cancer subtypes, as this information was used for later analyses. We treated NA values either by removing the cell line or by replacing it with a mean value, depending on the dataset. Since we want to take a look at the different brain cancer subtypes as part of our third milestone, we also created subtye data frames during the cleaning process. 

```{r}
#play around lines 43 to 76 
#also add the subtype classification in lines 80 to 91, code optimisation needed 
#++Descriptive statistics++

```


#Identification of effective drugs

The `prism` data frame gives information on treatments which were used in the screening effort. These treatments include 4,518 drugs with doses ranging from 0.00061034 $\mu M to 10 $\mu M. There are 8 standard doses into which we have divided the data frame by creating a list to store them. 

```{r}
# play around lines 106 to 141 
```

Nevertheless, treatments were given whose doses did not correspond to the standard one's. We have assigned these to the standard doses to which there is the least deviation, assuming that the focus of the project is on the drug itself and not on the dose used. 


To identify the most effective drugs, we looked at the effectiveness values of the `prism` data frame. The more negative the value, the more effective the treatment. Contrary to the threshold value 0.3 of Corsello *et al.* we have set the threshold value 0.2. We found this to be useful as it corresponds to the median of the ```brain_cancer``` data frame (filtered brain cancer cell lines from the ```prism``` data frame), allowing us to select half of the drugs by this step. 

In order to reduce the number of drugs and to be able to make later predictions for our main question independent of the dose, we selected drugs that are effective in all doses. To do this, we first identified the drugs whose mean effectiveness across all cell lines in the dose subset data frames was less than or equal to the established threshold. Second, we compared these drugs and selected the ones that are present in all subsets. Thereby we have obtained **51 drugs**.


```{r}
#hier würde ich einfach eine Liste mit den 51 Drogen reinpacken 
```


We decided to chose a dose to work on with, since the model we want to establish should output drugs for treatment regardless of their concentration. We selected dose 7, 10 $\mu M, s this has the highest variance and is therefore suitable for most treatments. 

```{r}
#und direkt die d7 dosage mit der variance begründen 
```


++Clustering of effective drugs++

```{r}
# Diagram ist im efficiency filtering, benötigt werden die Chunks 15 & 16 
```


Taking it as justification for not taking subtypes into account.

++Subtypes in boxplots represent the efficiency++

2) What are the targets of the effective drugs?

To analyse the targets of the previously described effective drugs, we 

```{r}
# ab chunk 10 im comparison.Rmd 
```


3) Are there any genetic markers that are specific for brain cancer subtypes?
- Examine gene targets of the effective drugs
- Find a relationship between gene targets and brain cancer subtypes
- Wilcoxon Signed Rank Test


4) What other factors contribute to predicting the effectiveness of a drug? 
- Estimate the relevant variables
- Look for correlations between variables and leave only variables with high variance
- Reduce the amount of dimensions by conducting a PCA
- Regression model with PCA
- Compare the real effectiveness with the estimated one 



Caution: This is a case for the multiplicity problem. While testing thousands of hypotheses simultaneously, the chance of getting false positives is increased. There are two possibilities of adjustment.

First: The Bonferroni correction: Correction of the FWER (family-wise error rate) so the probability of getting at least one false positive during multiple testing. In this way, the significance level alpha is adjustet to alpha/n.

Second: The Benjamini and Hochberg correction. This is a method to control the FDR (false discovery rate) so the proportion of false positives among the significant results. This method is more recommended for gene expression analysis.

https://www.reneshbedre.com/blog/multiple-hypothesis-testing-corrections.html



Rough version with possible visualizations (6 plots in total)


Q3:
- Visualization of most relevant genes in cell lines via a *heatmap* with shows the degree of expression